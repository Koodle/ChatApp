{"ast":null,"code":"/*Axios is a promise based HTTP client for the browser and Node. js\r\nsend asynchronous HTTP requests to REST endpoints and perform CRUD operations*/\nimport axios from \"axios\"; //redux store\n\nimport store from \"../store\"; //logout action\n\nimport { logout } from \"../store/actions/auth\"; //creates an AXIOS instance used to make requests to the Back-End\n// const API = axios.create({\n//     baseURL: \"http://127.0.0.1:3000\",\n//     headers: {\n//         \"Accept\": \"application/json\",\n//         \"Authorization\": `Bearer ${localStorage.getItem(\"token\").replace(/^\"(.*)\"$/, '$1') || \"\"}`  //check if we already have a token and set it\n//     }\n// })\n\nlet token = \"\";\nlocalStorage.hasOwnProperty('token') ? token = localStorage.getItem(\"token\").replace(/^\"(.*)\"$/, '$1') : token = \"\";\nconst API = axios.create({\n  baseURL: \"http://127.0.0.1:3000\",\n  headers: {\n    \"Accept\": \"application/json\",\n    \"Authorization\": token\n  }\n}); //create interceptor to listen to errors\n\nAPI.interceptors.response.use( //successful response\nres => {\n  return res;\n}, err => {\n  // token expired errors are always 401 error\n  if (err.response.status !== 401) {\n    throw err;\n  }\n\n  if (typeof err.response.data.error.name !== \"undefined\") {\n    if (err.response.data.error.name === \"TokenExpiredError\") {\n      //this error is provided by JWT\n      //logout user\n      store.dispatch(logout());\n      throw err;\n    }\n  }\n});\nexport default API;","map":{"version":3,"sources":["C:/Users/kazim/Desktop/chatApp/chat-frontend/src/services/api.js"],"names":["axios","store","logout","token","localStorage","hasOwnProperty","getItem","replace","API","create","baseURL","headers","interceptors","response","use","res","err","status","data","error","name","dispatch"],"mappings":"AAAA;AACA;AACA,OAAOA,KAAP,MAAkB,OAAlB,C,CACA;;AACA,OAAOC,KAAP,MAAkB,UAAlB,C,CACA;;AACA,SAAQC,MAAR,QAAqB,uBAArB,C,CAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAIC,KAAK,GAAG,EAAZ;AAEAC,YAAY,CAACC,cAAb,CAA4B,OAA5B,IAAuCF,KAAK,GAAGC,YAAY,CAACE,OAAb,CAAqB,OAArB,EAA8BC,OAA9B,CAAsC,UAAtC,EAAkD,IAAlD,CAA/C,GAAyGJ,KAAK,GAAG,EAAjH;AAEA,MAAMK,GAAG,GAAGR,KAAK,CAACS,MAAN,CAAa;AACrBC,EAAAA,OAAO,EAAE,uBADY;AAErBC,EAAAA,OAAO,EAAE;AACL,cAAU,kBADL;AAEL,qBAAiBR;AAFZ;AAFY,CAAb,CAAZ,C,CASA;;AACAK,GAAG,CAACI,YAAJ,CAAiBC,QAAjB,CAA0BC,GAA1B,EAEI;AACAC,GAAG,IAAI;AACH,SAAOA,GAAP;AACH,CALL,EAMIC,GAAG,IAAI;AACH;AACA,MAAIA,GAAG,CAACH,QAAJ,CAAaI,MAAb,KAAwB,GAA5B,EAAgC;AAC5B,UAAMD,GAAN;AACH;;AAED,MAAI,OAAOA,GAAG,CAACH,QAAJ,CAAaK,IAAb,CAAkBC,KAAlB,CAAwBC,IAA/B,KAAwC,WAA5C,EAAwD;AACpD,QAAIJ,GAAG,CAACH,QAAJ,CAAaK,IAAb,CAAkBC,KAAlB,CAAwBC,IAAxB,KAAkC,mBAAtC,EAA0D;AAAG;AACzD;AACAnB,MAAAA,KAAK,CAACoB,QAAN,CAAenB,MAAM,EAArB;AAEA,YAAMc,GAAN;AACH;AACJ;AACJ,CApBL;AAyBA,eAAeR,GAAf","sourcesContent":["/*Axios is a promise based HTTP client for the browser and Node. js\r\nsend asynchronous HTTP requests to REST endpoints and perform CRUD operations*/\r\nimport axios from \"axios\"\r\n//redux store\r\nimport store from \"../store\"\r\n//logout action\r\nimport {logout} from \"../store/actions/auth\"\r\n\r\n\r\n//creates an AXIOS instance used to make requests to the Back-End\r\n// const API = axios.create({\r\n//     baseURL: \"http://127.0.0.1:3000\",\r\n//     headers: {\r\n//         \"Accept\": \"application/json\",\r\n//         \"Authorization\": `Bearer ${localStorage.getItem(\"token\").replace(/^\"(.*)\"$/, '$1') || \"\"}`  //check if we already have a token and set it\r\n//     }\r\n// })\r\n\r\nlet token = \"\"\r\n\r\nlocalStorage.hasOwnProperty('token') ? token = localStorage.getItem(\"token\").replace(/^\"(.*)\"$/, '$1') : token = \"\"\r\n\r\nconst API = axios.create({\r\n    baseURL: \"http://127.0.0.1:3000\",\r\n    headers: {\r\n        \"Accept\": \"application/json\",\r\n        \"Authorization\": token\r\n    }\r\n})\r\n\r\n\r\n//create interceptor to listen to errors\r\nAPI.interceptors.response.use(\r\n\r\n    //successful response\r\n    res => {\r\n        return res\r\n    },\r\n    err => {\r\n        // token expired errors are always 401 error\r\n        if (err.response.status !== 401){\r\n            throw err\r\n        }\r\n\r\n        if (typeof err.response.data.error.name !== \"undefined\"){\r\n            if (err.response.data.error.name  === \"TokenExpiredError\"){  //this error is provided by JWT\r\n                //logout user\r\n                store.dispatch(logout())\r\n                \r\n                throw err\r\n            }\r\n        }\r\n    }\r\n\r\n)\r\n\r\n\r\nexport default API"]},"metadata":{},"sourceType":"module"}